name: CI

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v1
    - name: Connect to mysql server
      run: |
        mysql --user=root --password=root -e 'CREATE DATABASE runtimeterror;'
        mysql --user=root --password=root -D runtimeterror < sql_test_dumps/users_dump.sql
        mysql --user=root --password=root -D runtimeterror < sql_test_dumps/notifications_dump.sql
    - name: Run gradle tests
      run: |
        cd rollerball
        gradle test
